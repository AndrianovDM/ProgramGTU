import numpy as np
import scipy as sp
import itertools
from math import *
from fuel import *
from scipy.interpolate import interp2d
from scipy.optimize import fsolve
from scipy.interpolate import make_interp_spline
from scipy.optimize import fsolve

ksi_leaks_02 =[2.438, 2.41, 2.383, 2.341, 2.314, 2.293, 2.269, 2.252, 2.234, 2.217, 2.193, 2.179, 2.165, 2.151, 2.133, 2.119, 2.102, 2.088, 2.067, 2.056, 2.042, 2.032, 2.021, 2.014, 2.007, 1.996, 1.989, 1.986, 1.979, 1.979, 1.975, 1.968, 1.968, 1.965, 1.961] 
Dh_leaks_02 = [3.023, 3.108, 3.244, 3.466, 3.688, 3.875, 4.131, 4.37, 4.591, 4.796, 5.171, 5.41, 5.716, 6.077, 6.504, 6.859, 7.312, 7.778, 8.458, 8.861, 9.562, 10.087, 10.595, 10.875, 11.376, 12.181, 12.654, 13.108, 13.609, 13.938, 14.326, 14.824, 15.246, 15.597, 15.947]
ro_02 = [0.2 for i in range(len(ksi_leaks_02))]

ksi_leaks_03 =[2.732, 2.673, 2.632, 2.59, 2.556, 2.507, 2.473, 2.445, 2.417, 2.393, 2.366, 2.338, 2.324, 2.314, 2.3, 2.286, 2.269, 2.262, 2.252, 2.245, 2.238, 2.227, 2.22, 2.217, 2.207, 2.207, 2.207, 2.207]
Dh_leaks_03 = [3.023, 3.227, 3.432, 3.688, 3.943, 4.37, 4.745, 5.12, 5.529, 5.955, 6.504, 7.105, 7.536, 7.847, 8.231, 8.721, 9.282, 9.667, 10.052, 10.63, 11.106, 11.754, 12.304, 12.882, 13.54, 14.113, 15.264, 15.965]
ro_03 = [0.3 for i in range(len(ksi_leaks_03))]

ksi_leaks_04 =[2.998, 2.932, 2.877, 2.836, 2.794, 2.759, 2.732, 2.718, 2.694, 2.673, 2.659, 2.645, 2.628, 2.614, 2.594, 2.576, 2.566, 2.549, 2.535, 2.521, 2.507, 2.493, 2.483, 2.476, 2.466, 2.459, 2.452, 2.445, 2.438, 2.435, 2.431, 2.428, 2.421, 2.417, 2.41, 2.41, 2.407, 2.407, 2.407]
Dh_leaks_04 = [3.057, 3.296, 3.568, 3.841, 4.148, 4.455, 4.745, 4.949, 5.222, 5.512, 5.768, 5.955, 6.273, 6.539, 6.965, 7.398, 7.709, 8.108, 8.511, 8.914, 9.352, 9.807, 10.157, 10.543, 10.91, 11.34, 11.718, 12.164, 12.584, 12.829, 13.264, 13.609, 14.113, 14.54, 14.877, 15.211, 15.579, 15.895, 15.965]
ro_04 = [0.4 for i in range(len(ksi_leaks_04))]

ksi_leaks_05 =[3.296, 3.259, 3.215, 3.163, 3.113, 3.068, 3.015, 2.97, 2.918, 2.887, 2.856, 2.829, 2.811, 2.791, 2.777, 2.763, 2.749, 2.739, 2.732, 2.725, 2.715, 2.715, 2.704, 2.697, 2.69, 2.687, 2.683, 2.677, 2.673, 2.67, 2.663, 2.659, 2.656, 2.645, 2.642]
Dh_leaks_05 = [3.074, 3.21, 3.398, 3.62, 3.841, 4.114, 4.455, 4.796, 5.29, 5.682, 6.095, 6.557, 6.877, 7.416, 7.796, 8.301, 8.826, 9.229, 9.667, 10.192, 10.56, 10.84, 11.322, 11.826, 12.339, 12.707, 13.195, 13.609, 13.903, 14.167, 14.486, 14.877, 15.211, 15.632, 15.93]
ro_05 = [0.5 for i in range(len(ksi_leaks_05))]

def inter(function, parametr, x):
    parametr, residuals, rank, sv, rcond = np.polyfit(parametr, function, 25, full=True)
    function = sp.poly1d(parametr)
    return function(x)

def ksi_leaks(Dh, ro):
    ro_i = [0.2, 0.3, 0.4, 0.5]
    ksi02 = inter(ksi_leaks_02, Dh_leaks_02, Dh)
    ksi03 = inter(ksi_leaks_03, Dh_leaks_03, Dh)
    ksi04 = inter(ksi_leaks_04, Dh_leaks_04, Dh)
    ksi05 = inter(ksi_leaks_05, Dh_leaks_05, Dh)
    ksi_data = [ksi02, ksi03, ksi04, ksi05]
    ksi = inter(ksi_data, ro_i, ro)
    return ksi

# print(ksi_leaks(12, 0.2))